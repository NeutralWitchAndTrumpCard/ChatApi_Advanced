<!DOCTYPE html>
<html lang="ko">
<meta charset="UTF-8">

<head>
    <title>Account Info</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        form {
            display: flex;
            flex-direction: column;
            width: 300px;
            gap: 10px;
        }
    </style>
    <script>
            window.onload = function() {
                // 로그인 상태 확인
                checkLoginStatus();

                //fetch('/api/accountInfo')
                fetch("/getAccountInfo")
                    .then(response => response.json())
                    .then(data => {
                        console.log("Data received: ", data);
                        document.getElementById('memberId').innerText = data.id;
                        document.getElementById('memberName').innerText = data.name;
                        document.getElementById('memberEmail').innerText = data.email;
                    })
                    .catch(error => console.error('Error:', error));
            };

            function checkLoginStatus() {
                // 로그인 상태 확인
                var response = fetch('/checkLoginStatus', {credentials: 'include'});

                response
                    .then(response => {
                        if (response.status === 200) {
                            response
                                .then(response => response.json())
                                .then(data => {
                                    if (data.loggedIn) {
                                        // 로그인 상태
                                        // 회원 정보 가져오기
                                        fetch("/getAccountInfo", {credentials: 'include'})
                                            .then(response => response.json())
                                            .then(data => {
                                                // 회원 정보 출력
                                                document.getElementById('memberId').innerText = data.id;
                                                document.getElementById('memberName').innerText = data.name;
                                                document.getElementById('memberEmail').innerText = data.email;
                                            })
                                            .catch(error => console.error('Error:', error));
                                    }
                                })
                                .catch(error => console.error('Error:', error));
                        } else {
                            console.log('Error: Status code is not 200.');
                        }
                    })
                    .catch(error => console.error('Error:', error));
            }
    </script>
</head>

<body>
<h2>회원정보</h2>
<p>ID: <span id="memberId"></span></p>
<p>이름: <span id="memberName"></span></p>
<p>이메일: <span id="memberEmail"></span></p>

<button onclick="window.location.href='../account/account_modify.html'">회원정보 수정</button>
<button onclick="window.location.href='../account/account_password_modify.html'">비밀번호 변경</button>
</body>

