<!DOCTYPE html>
<html lang="ko">
<meta charset="UTF-8">

<head>
    <title>Account Info</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        form {
            display: flex;
            flex-direction: column;
            width: 300px;
            gap: 10px;
        }
    </style>
    <script>
        window.onload = function() {
            // 로그인 상태 확인
            checkLoginStatus();

            // HttpSession 객체를 사용하여 로그인한 사용자의 정보를 가져옵니다.
            const session = localStorage.getItem("session");
            if (session) {
                const user = JSON.parse(session);

                // 회원 정보 출력
                document.getElementById('memberId').innerText = user.id;
                document.getElementById('memberName').innerText = user.name;
                document.getElementById('memberEmail').innerText = user.email;
            }
        };

        function checkLoginStatus() {
            // 로그인 상태 확인
            var response = fetch('/checkLoginStatus', {credentials: 'include'});

            response
                .then(response => {
                    if (response.status === 200) {
                        response
                            .then(response => response.json())
                            .then(data => {
                                if (data.loggedIn) {
                                    // 로그인 상태
                                    // HttpSession 객체에 로그인한 사용자의 정보를 저장합니다.
                                    localStorage.setItem("session", JSON.stringify(data));
                                }
                            })
                            .catch(error => console.error('Error:', error));
                    } else {
                        console.log('Error: Status code is not 200.');
                    }
                })
                .catch(error => console.error('Error:', error));
            /*
            const isLoggedIn = localStorage.getItem("isLoggedIn");
            // 로그인 상태가 있는 경우 회원 정보를 조회합니다.
            if (isLoggedIn) {
                // `fetch()` 함수를 사용하여 회원 정보를 조회합니다.
                fetch("/api/accountInfo")
                    .then((response) => {
                        // `response` 객체를 `Promise` 객체로 변환합니다.
                        response.json().then((data) => {
                            // 회원 정보를 화면에 표시합니다.
                            document.getElementById("id").textContent = data.id;
                            document.getElementById("name").textContent = data.name;
                            document.getElementById("email").textContent = data.email;
                        });
                    });
            }
           */
        }
    </script>
</head>

<body>
<h2>회원정보</h2>
<p>ID: <span id="memberId"></span></p>
<p>이름: <span id="memberName"></span></p>
<p>이메일: <span id="memberEmail"></span></p>

<button onclick="window.location.href='../account/account_modify.html'">회원정보 수정</button>
<button onclick="window.location.href='../account/account_password_modify.html'">비밀번호 변경</button>
</body>

